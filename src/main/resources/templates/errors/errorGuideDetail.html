<html layout:decorate="~{layout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<th:block layout:fragment="content">

    <div class="py-4">
        <div class="subtitle_css" id="errorTitle" style="font-size: clamp(20px, 4vw, 28px);"></div>

        <div class="py-3">
            <label class="form-label pb-2" id="errorSubtitle" style="font-size: clamp(16px, 3vw, 22px);"></label>
            <div class="form_sm_css" id="errorSteps" style="max-width: 1300px; margin: 0 auto; font-size: clamp(14px, 2.5vw, 18px);">
                <!-- JS에서 내용 삽입 -->
            </div>
            <div class="d-flex justify-content-end mt-3">
                <a href="/errors/guide" class="write_css text-end" style="font-size: clamp(14px, 2.5vw, 18px);">목록</a>
            </div>
        </div>
    </div>
</th:block>

<script th:inline="javascript" layout:fragment="script">
    const params = new URLSearchParams(window.location.search);
    const guideId = params.get('id');

    const guides = {
        '101': {
            title: '101 ERROR',
            subtitle: '프레임 정렬 불량 대처가이드',
            steps: [
                '<span style="color: red;"><b>⚠ 안전 주의:</b> 기계 가동 중지 후 클램프·지그에 손대지 마세요</span>',
                '프레임 고정 클램프 위치와 강도 점검 (마킹 위치 불일치 확인)',
                '프레임 용접부 변형·비틀림 여부 육안 점검',
                '교정 지그를 사용해 프레임을 재고정 후, 공정 라인 재시작'
            ]
        },
        '102': {
            title: '102 ERROR',
            subtitle: '용접 불량 발생 시 대처가이드',
            steps: [
                '<span style="color: red;"><b>⚠ 안전 주의:</b> 용접기 전원 차단 후 전극 및 팁을 점검하세요</span>',
                '용접기 전극 팁 마모 및 탄화물 부착 여부 확인',
                '용접기 열·전류 설정값 제조 표준과 비교',
                '용접 조건을 보정 후 테스트 샘플 제작, 불량 반복 시 관리자 보고'
            ]
        },
        '103': {
            title: '103 ERROR',
            subtitle: '모터 배선 불량 대처가이드',
            steps: [
                '<span style="color: red;"><b>⚠ 주의:</b> 전원 OFF 후 커넥터·배선 작업을 진행하세요</span>',
                '모터 커넥터 및 배선 연결 상태 확인, 단선·눌림 흔적 점검',
                '멀티미터로 모터 출력 라인 전류·저항 값 측정',
                '배선 재연결 후 시운전, 문제 지속 시 모터 교체 검토'
            ]
        },
        '104': {
            title: '104 ERROR',
            subtitle: '컨트롤러 펌웨어 불일치 대처가이드',
            steps: [
                '컨트롤러 현재 펌웨어 버전 및 릴리즈 노트 확인',
                '펌웨어 업데이트 파일 무결성 검증 후 재설치',
                '컨트롤러 리셋 후 설정값 재적용, 시운전 확인',
                '문제 반복 시 공정 라인 중지 후 관리자 호출'
            ]
        },
        '105': {
            title: '105 ERROR',
            subtitle: '배터리팩 충전 불량 대처가이드',
            steps: [
                '<span style="color: red;"><b>⚠ 중요:</b> 고전압 경고! 반드시 절연장갑 착용 후 점검</span>',
                '충전 단자·케이블 연결 상태 점검, 접점 오염 여부 확인',
                '배터리팩 전압 측정, 셀 밸런스 이상 여부 확인',
                '충전기 출력 확인, 필요 시 충전기 교체 후 재충전'
            ]
        },
        '106': {
            title: '106 ERROR',
            subtitle: '휠 장착 오차 대처가이드',
            steps: [
                '휠 허브·스포크 정렬 상태 점검, 이상시 교정',
                '고정 볼트·너트 토크 값 측정, 제조 표준과 비교',
                '휠 얼라인먼트 장비로 교정 작업 수행',
                '공정 라인 재시작 전, 재작업 승인 체크리스트 작성'
            ]
        },
        '201': {
            title: '201 ERROR',
            subtitle: '자재 재고 부족 안내',
            steps: [
                '재고 부족 자재: ERP 시스템에서 실시간 확인',
                '대체 자재 가능 여부 확인',
                '부족 자재 자동 주문 → <a href="/order/inventory" target="_blank" style="text-decoration: underline;">재고주문 페이지 이동</a>',
                '재고 확보 전 생산 일정 조정, 관리자 보고'
            ]
        },
        '202': {
            title: '202 ERROR',
            subtitle: '설비 센서 경고 대처가이드',
            steps: [
                '<span style="color: red;"><b>⚠ 긴급:</b> 설비 이상 경고 발생 시 즉시 공정 중단!</span>',
                '경고 발생 센서 구역(온도·압력·진동) 식별',
                '설비 로그 수집 및 사진 촬영 후 관리자 보고',
                '필요 시 설비 제조사 기술지원 요청'
            ]
        }
    };


    const guide = guides[guideId];

    if (guide) {
        document.getElementById('errorTitle').innerHTML = guide.title;
        document.getElementById('errorSubtitle').innerHTML = guide.subtitle;

        const stepsContainer = document.getElementById('errorSteps');
        stepsContainer.innerHTML = '';
        guide.steps.forEach((step, index) => {
            const div = document.createElement('div');
            div.className = 'mb-4';

            // 첫 번째 단계가 빨간색 주의 문구면 아이콘 없이 출력
            if (index === 0 && step.includes('color: red;')) {
                div.innerHTML = step;
            } else {
                div.innerHTML = `<i class="bi bi-check2-square"></i> ${step}`;
            }
            stepsContainer.appendChild(div);
        });
    } else {
        document.getElementById('errorTitle').textContent = '알 수 없는 ERROR';
        document.getElementById('errorSubtitle').textContent = '대처가이드를 찾을 수 없습니다.';
    }
</script>
</html>
